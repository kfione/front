(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["dao"],{9708:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAMAAABF0y+mAAAASFBMVEUAAAC1tcW7u8nAwMa1tce2tsW2tsW2tsa2tsa6usy2tsa2tsa2tsW5uci3t8a3t8W2tse1tca5uca3t8S1tce3t8W4uMa2tsVbXA4AAAAAGHRSTlMAgBAIeVVCLmcMa1BKFTYqGnEgTGFaJjsOttTyAAABD0lEQVQoz42SWxaDIAxEHZ6CUPDZ/e+0BILY05/mhyQTLiMy/RfyCuc8n+GSP5ILChwquG/txRLLr6e2U0vbKGW0mvJlaAtJoldCP9V3KSoopiTqIaXx5knVNKkrXDZViQ7VtB7NzUy5ZrAsDZq6gF2IYs0yjRCWNxooWoDAW2mIZhudgAkwVNnGPYFc8U7SdiBW48BZlhlwVDJMpXadzdnR/LA3z7kAjja9TXen3+rWbJpmgcUKHd1cWB1rTOTUs80VsB3WqRZY74T9Kj7ejQ1zsS1rFo66SupM47f4ON0Ry4HqrreiYu9fGFC0bczmFSX8YsziKVvz17sMeAQ/vxHC+KZ4U/i/4XJK2U1/xge6cQfm/uXi8gAAAABJRU5ErkJggg=="},"9e67":function(t,e,a){},a1d8:function(t,e,a){"use strict";a("9e67")},b2a0:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"dao_box"},[t._l(t.daoList,(function(e,i){return n("div",{staticClass:"list-box-item",class:e.myLocked>0?"list-box-itemA":"list-box-itemB"},[n("div",{staticClass:"box-item-top"},[n("img",{attrs:{src:a("f734")}}),n("span",[t._v(t._s("LOCK "+e.days+" DAYS"))]),n("p",[t._v(t._s("APY "+t.$util.mathFixed(t.$util.mathMul(e.apy,100),2)+"%"))])]),n("div",{staticClass:"box-item-bottom"},[n("div",{staticClass:"item-bottom-claim"},[n("div",[n("p",{staticClass:"claim-title"},[t._v("Total locked")]),n("p",{staticClass:"claim-value"},[t._v(t._s(t.$util.mathFixed(e.totalLocked,2)+" KFI"))]),n("div",{staticClass:"claim-btn"})]),n("div",[n("p",{staticClass:"claim-title"},[t._v("My locked")]),n("p",{staticClass:"claim-value"},[t._v(t._s(t.$util.mathFixed(e.myLocked,2)+" KFI"))]),n("div",{staticClass:"claim-btn"})]),n("div",[n("a-tooltip",{staticClass:"claim-title",attrs:{placement:"bottomLeft",title:"When you deposit new KFI, the contract will automatically harvest rewards from previously deposited tokens."}},[n("span",[t._v("Reward")]),n("img",{staticClass:"slippage_svg",attrs:{src:a("9708"),alt:"slippage_icon"}})]),n("p",{staticClass:"claim-value"},[t._v(t._s(t.$util.mathFixed(e.kfiReward,4)+" KFI"))]),n("div",{staticClass:"claim-btn"},[n("a-button",{staticClass:"harvest_btn",attrs:{type:"primary",loading:t.excutingH},on:{click:function(a){return a.stopPropagation(),t.onHarvest(e)}}},[t._v("Harvest")])],1)],1),n("div",[n("a-tooltip",{staticClass:"claim-title",attrs:{placement:"bottomLeft",title:"If you have deposited multiple times, only the last deposit will be recorded. The time of the prior deposit will remain unchanged."}},[n("span",[t._v("Time left")]),n("img",{staticClass:"slippage_svg",attrs:{src:a("9708"),alt:"slippage_icon"}})]),n("p",{staticClass:"claim-text"},[t._v(t._s(t.$util.convertTime(e.time))),n("span",[t._v(t._s("(of "+e.days+" days)"))])])],1)]),n("div",{staticClass:"item-bottom-input"},[n("div",{staticClass:"input-item-top"},[n("div",{staticClass:"btn_switch_div"},[n("div",{staticClass:"btn_switch",class:"Lock"==t.btnType&&"btn_active_switch",on:{click:function(a){return t.onBtnSwitch(e,"Lock")}}},[t._v("Lock")]),n("div",{staticStyle:{width:"3px"}}),n("div",{staticClass:"btn_switch",class:"Unlock"==t.btnType&&"btn_active_switch",on:{click:function(a){return t.onBtnSwitch(e,"Unlock")}}},[t._v("Unlock")])]),n("a-input",{staticClass:"input_btn",attrs:{placeholder:"0"},model:{value:e.amount,callback:function(a){t.$set(e,"amount",a)},expression:"item.amount"}},[n("a-button",{staticClass:"input-max",attrs:{slot:"suffix",type:"link"},on:{click:function(a){return a.stopPropagation(),t.max(e)}},slot:"suffix"},[t._v(t._s("MAX"))])],1)],1),n("div",{staticClass:"input-item-bottom"},[n("p",{directives:[{name:"show",rawName:"v-show",value:"Lock"==t.btnType,expression:"btnType=='Lock'"}]},[t._v(t._s("Wallet Balance: "+t.$util.mathFixed(t.balance,8)+" KFI"))]),n("p",{directives:[{name:"show",rawName:"v-show",value:"Unlock"==t.btnType,expression:"btnType=='Unlock'"}]},[t._v(t._s("Unlocked: "+t.$util.mathFixed(e.canLock,8)+" KFI"))])])]),n("div",{staticClass:"item-bottom-text"},[n("a-button",{directives:[{name:"show",rawName:"v-show",value:"Lock"==t.btnType&&!e.isEnable,expression:"btnType=='Lock'&&!item.isEnable"}],staticClass:"deposit_btn",on:{click:function(a){return a.stopPropagation(),t.authorizationOk(e)}}},[t._v("Approve")]),n("a-button",{directives:[{name:"show",rawName:"v-show",value:"Lock"==t.btnType&&e.isEnable,expression:"btnType=='Lock'&&item.isEnable"}],staticClass:"deposit_btn",attrs:{loading:t.excutingD,disabled:!e.amount},on:{click:function(a){return a.stopPropagation(),t.onLock(e)}}},[t._v("Deposit")]),n("a-button",{directives:[{name:"show",rawName:"v-show",value:"Unlock"==t.btnType,expression:"btnType=='Unlock'"}],staticClass:"deposit_btn",attrs:{loading:t.excutingW,disabled:!e.amount},on:{click:function(a){return a.stopPropagation(),t.onUnLock(e)}}},[t._v("Withdraw")])],1)])])})),n("div",{directives:[{name:"show",rawName:"v-show",value:0==t.daoList.length,expression:"daoList.length==0"}],staticClass:"list-box-item"},[n("a-empty")],1)],2)},i=[],r=a("1da1"),s=(a("96cf"),a("4795"),a("e25e"),a("b680"),a("d1f3")),o=a("901e"),c=a.n(o),u=a("2b0e"),l={name:"Dao",data:function(){return{daoList:[],btnType:"Lock",balance:0,excutingH:!1,excutingD:!1,excutingW:!1}},mounted:function(){var t=this;setTimeout((function(){t.refresh()}),1500)},methods:{refresh:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.getBalanceKfi(),t.getPoolList(window.data.lockpools);case 2:case"end":return e.stop()}}),e)})))()},getBalanceKfi:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=new t.$store.state.web3Read.eth.Contract(window.config.token_abi,window.config.kfi_addr),e.next=3,a.methods.balanceOf(t.$store.state.wallet_address).call();case 3:n=e.sent,t.balance=t.$util.mathDiv(n,t.$util.mathPow(10,18));case 5:case"end":return e.stop()}}),e)})))()},getPoolList:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var n,i,r,s,o,l,m,d,p;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:e.daoList=t,n=0;case 2:if(!(n<window.data.lockpools.length)){a.next=25;break}return i=new e.$store.state.web3Read.eth.Contract(window.config.pool_abi,window.data.lockpools[n].lock_addr),a.next=6,i.methods.poolInfo().call({from:e.$store.state.wallet_address});case 6:return r=a.sent,a.next=9,i.methods.pendingKfi().call({from:e.$store.state.wallet_address});case 9:return s=a.sent,a.next=12,i.methods.canLock(e.$store.state.wallet_address).call({from:e.$store.state.wallet_address});case 12:return o=a.sent,l=new e.$store.state.web3Writer.eth.Contract(window.config.token_abi,window.config.kfi_addr),a.next=16,l.methods.allowance(e.$store.state.wallet_address,window.data.lockpools[n].lock_addr).call();case 16:m=a.sent,m>0&&(m=e.$util.mathDiv(m,e.$util.mathPow(10,18))),d=!1,d=c()(m).comparedTo(e.balance)>0,p=Object.assign({},{days:window.data.lockpools[n].days,lock_addr:window.data.lockpools[n].lock_addr,apy:e.$util.mathDiv(r[0],e.$util.mathPow(10,18)),totalLocked:e.$util.mathDiv(r[1],e.$util.mathPow(10,18)),myLocked:e.$util.mathDiv(r[2],e.$util.mathPow(10,18)),time:r[3],amount:"",kfiReward:e.$util.mathDiv(s,e.$util.mathPow(10,18)),isEnable:d,canLock:e.$util.mathDiv(o,e.$util.mathPow(10,18))}),u["a"].set(e.daoList,n,p);case 22:n++,a.next=2;break;case 25:case"end":return a.stop()}}),a)})))()},onHarvest:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!e.excutingD){a.next=2;break}return a.abrupt("return");case 2:n=e;try{n.excutingH=!0,i=new e.$store.state.web3Writer.eth.Contract(window.config.pool_abi,t.lock_addr),i.methods.withdrawReward().send({from:e.$store.state.wallet_address},(function(e,a){t.amount="",e?(n.$notification["error"]({message:"Harvest failure",description:e.message}),n.excutingH=!1):n.checkStatusH(a,(function(){n.$notification["success"]({message:"Harvest successfully"}),t.kfiReward=0}))}))}catch(r){n.$notification["error"]({message:"operation failed",description:r}),n.excutingH=!1}case 4:case"end":return a.stop()}}),a)})))()},checkStatusH:function(t,e){var a=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=a,a.excutingH){n.next=3;break}return n.abrupt("return");case 3:a.checkTimer&&clearInterval(a.checkTimer),a.checkTimer=setInterval(Object(r["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,s["a"](t);case 2:n=a.sent,n&&n.result&&(r=parseInt(n.result.status),1==r&&(clearInterval(i.checkTimer),i.excutingH&&(i.excutingH=!1,setTimeout((function(){e()}),2e3))));case 4:case"end":return a.stop()}}),a)}))),2e3);case 5:case"end":return n.stop()}}),n)})))()},onBtnSwitch:function(t,e){t.amount="",this.btnType=e},max:function(t){"Lock"==this.btnType?t.amount=this.$util.mathFixed(this.balance,8):t.amount=this.$util.mathFixed(t.canLock,8)},authorizationOk:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var n,i,r,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e,i=e.$store.state.web3Writer,r=new i.eth.Contract(window.config.token_abi,window.config.kfi_addr),a.next=5,r.methods.totalSupply().call();case 5:s=a.sent,r.methods.approve(t.lock_addr,s).send({from:e.$store.state.wallet_address},(function(e,a){e?n.$notification["error"]({message:"operation failed",description:e.message}):n.checkStatus(a,(function(){n.$notification["success"]({message:"Authorization succeeded"}),t.isEnable=!0}))}));case 7:case"end":return a.stop()}}),a)})))()},checkStatus:function(t,e){var a=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:i=a,a.checkTimer&&clearInterval(a.checkTimer),a.checkTimer=setInterval(Object(r["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,s["a"](t);case 2:n=a.sent,n&&n.result&&(r=parseInt(n.result.status),1==r&&(clearInterval(i.checkTimer),setTimeout((function(){e()}),2e3)));case 4:case"end":return a.stop()}}),a)}))),2e3);case 3:case"end":return n.stop()}}),n)})))()},onLock:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var n,i,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!c()(t.amount).isGreaterThan(e.$util.mathFixed(e.balance,8))){a.next=3;break}return e.$message.error("Insufficient balance"),a.abrupt("return");case 3:if(!e.excutingD){a.next=5;break}return a.abrupt("return");case 5:n=e;try{n.excutingD=!0,i=e.$util.mathMul(t.amount,e.$util.mathPow(10,18)),r=new e.$store.state.web3Writer.eth.Contract(window.config.pool_abi,t.lock_addr),r.methods.lock(i.toFixed()).send({from:e.$store.state.wallet_address},(function(e,a){t.amount="",e?(n.$notification["error"]({message:"Lock failure",description:e.message}),n.excutingD=!1):n.checkStatusD(a,(function(){n.$notification["success"]({message:"Lock successfully"}),n.getPoolList(n.daoList)}))}))}catch(s){console.error(s),n.$notification["error"]({message:"operation failed",description:s}),n.excutingD=!1}case 7:case"end":return a.stop()}}),a)})))()},checkStatusD:function(t,e){var a=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=a,a.excutingD){n.next=3;break}return n.abrupt("return");case 3:a.checkTimer&&clearInterval(a.checkTimer),a.checkTimer=setInterval(Object(r["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,s["a"](t);case 2:n=a.sent,n&&n.result&&(r=parseInt(n.result.status),1==r&&(clearInterval(i.checkTimer),i.excutingD&&(i.excutingD=!1,setTimeout((function(){e()}),2e3))));case 4:case"end":return a.stop()}}),a)}))),2e3);case 5:case"end":return n.stop()}}),n)})))()},onUnLock:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var n,i,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!c()(t.amount).isGreaterThan(e.$util.mathFixed(t.canLock,8))){a.next=3;break}return e.$message.error("Insufficient mortgage"),a.abrupt("return");case 3:if(!e.excutingW){a.next=5;break}return a.abrupt("return");case 5:n=e;try{n.excutingW=!0,i=e.$util.mathMul(t.amount,e.$util.mathPow(10,18)),r=new e.$store.state.web3Writer.eth.Contract(window.config.pool_abi,t.lock_addr),r.methods.unlock(i.toFixed()).send({from:e.$store.state.wallet_address},(function(e,a){t.amount="",e?(n.$notification["error"]({message:"UnLock failed",description:e.message}),n.excutingW=!1):n.checkStatusW(a,(function(){n.$notification["success"]({message:"UnLock successfully"}),n.getPoolList(n.daoList)}))}))}catch(s){n.$notification["error"]({message:"operation failed",description:s}),n.excutingW=!1}case 7:case"end":return a.stop()}}),a)})))()},checkStatusW:function(t,e){var a=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=a,a.excutingW){n.next=3;break}return n.abrupt("return");case 3:a.checkTimer&&clearInterval(a.checkTimer),a.checkTimer=setInterval(Object(r["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,s["a"](t);case 2:n=a.sent,n&&n.result&&(r=parseInt(n.result.status),1==r&&(clearInterval(i.checkTimer),i.excutingW&&(i.excutingW=!1,setTimeout((function(){e()}),2e3))));case 4:case"end":return a.stop()}}),a)}))),2e3);case 5:case"end":return n.stop()}}),n)})))()}}},m=l,d=(a("a1d8"),a("2877")),p=Object(d["a"])(m,n,i,!1,null,null,null);e["default"]=p.exports},d1f3:function(t,e,a){"use strict";function n(t){var e={jsonrpc:"2.0",method:"eth_getTransactionReceipt",params:[t],id:1};return ajax({url:window.config.tx_status,method:"POST",data:e})}a.d(e,"a",(function(){return n}))},f734:function(t,e,a){t.exports=a.p+"static/img/kfi_coin.f02ddfc8.png"}}]);